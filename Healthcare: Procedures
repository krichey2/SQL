-- What procedures are we performing?

-- What procedures are we performing?
SELECT * 
FROM
(SELECT 
DESCRIPTION
,COUNT(*) AS TOTAL_PROCS
FROM HEALTHCARE.PROCEDURES
WHERE DATE >= 2019-01-01
AND DATE < 2020-01-01
GROUP BY DESCRIPTION)PROCS
ORDER BY TOTAL_PROCS DESC;


-- How many different types of procedures did we perform in
2019?

SELECT ENC.ENCOUNTERCLASS
, COUNT(*)TOTAL_PROCS_FOR_CLASS
FROM HEALTHCARE.PROCEDURES PROCS
JOIN HEALTHCARE.ENCOUNTERS ENC ON PROCS.ENCOUNTER=ENC.Id
WHERE DATE>= 2019-01-01
AND DATE >2020-01-01
GROUP BY ENC.ENCOUNTERCLASS;


--  How many procedures were performed across each care
setting (inpatient/ambulatory)?

SELECT ENC.ENCOUNTERCLASS
, COUNT(*)TOTAL_PROCS_FOR_CLASS
FROM HEALTHCARE.PROCEDURES PROCS
JOIN HEALTHCARE.ENCOUNTERS ENC ON PROCS.ENCOUNTER=ENC.Id
WHERE DATE>= 2019-01-01
AND DATE >2020-01-01
GROUP BY ENC.ENCOUNTERCLASS;

-- Which organizations performed the most inpatient procedures in 2019?

SELECT ENC.ORGANIZATION
,COUNT(*) AS TOTAL_PROCS
FROM HEALTHCARE.PROCEDURES PROCS
JOIN HEALTHCARE.ENCOUNTERS ENC ON PROCS.ENCOUNTER=ENC.ID
JOIN HEALTHCARE.ORGANIZATIONS ORG ON ENC.ORGANIZATION=ORG.ID
WHERE DATE>= 2019-01-01
AND DATE >2020-01-01
AND ENC.ENCOUNTERCLASS='inpatient'
GROUP BY ENC.ORGANIZATION;

